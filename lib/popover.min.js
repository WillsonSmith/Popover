!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("popover",[],e):"object"==typeof exports?exports.popover=e():t.popover=e()}(this,function(){return function(t){function e(o){if(i[o])return i[o].exports;var n=i[o]={exports:{},id:o,loaded:!1};return t[o].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){return e[t+1<=e.length-1?t+1:0]}function n(t,e){return e[t-1>=0?t-1:e.length-1]}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),a=16,s=1.05,d=document.querySelector(".popover-holder"),c=document.getElementById("popover-deactivate-cover"),h=Array.from(document.getElementsByClassName("popover-activator")).map(function(t){return t.getAttribute("data-popover-activator-for")}),u=function(){function t(e,o){var n=this;i(this,t),this.node=e,this.contents=e.querySelector(".popover-contents"),this.activated=!1,this.shiftDown=!1,this.focusableElements=function(t){var e=t||document.body;return o(e).filter(function(t){return!h.includes(t.id)})},this.constrainedWidth=this.node.hasAttribute("data-constrain-width"),this.activator=document.querySelector('[data-popover-activator-for="'+e.id+'"]'),document.addEventListener("keydown",function(t){16===t.keyCode&&(n.shiftDown=!0)}),document.addEventListener("keyup",function(t){16===t.keyCode&&(n.shiftDown=!1)}),this.node.addEventListener("keydown",this._popoverTabHandler.bind(this)),this.node.addEventListener("blur",this._blurEventHandler.bind(this)),this.activator.addEventListener("focus",this.activatePopover.bind(this)),this.activator.addEventListener("click",function(){n.activator.focus()}),this.activator.addEventListener("keydown",this._activatorTabHandler.bind(this)),c.addEventListener("click",this.deactivatePopover.bind(this)),window.addEventListener("resize",this._resizePopover.bind(this))}return r(t,[{key:"deactivatePopover",value:function(){c.removeAttribute("data-popover-active"),this.node.setAttribute("data-hidden","true"),this.node.removeAttribute("style"),this.activated=!1}},{key:"activatePopover",value:function(){this.activated||(this._positionPopover(),c.setAttribute("data-popover-active","true"),this.node.removeAttribute("data-hidden"),this.activated=!0)}},{key:"_blurEventHandler",value:function(t){this.node.contains(t.relatedTarget)||t.relatedTarget===this.activator||this.deactivatePopover()}},{key:"_popoverTabHandler",value:function(t){t.preventDefault();var e=this.focusableElements(this.node),i=this.focusableElements().filter(function(t){return!d.contains(t)}),n=e.indexOf(document.activeElement);9!==t.keyCode||this.shiftDown||(n<e.length-1&&e[n+1].focus(),n===e.length-1&&(o(i.indexOf(this.activator),i).focus(),this.deactivatePopover())),9===t.keyCode&&this.shiftDown&&(n>0&&e[n-1].focus(),0===n&&this.node.focus(),n<0&&this.activator.focus())}},{key:"_activatorTabHandler",value:function(t){if(this.activated){t.preventDefault();var e=this.focusableElements(this.node),i=this.focusableElements().filter(function(t){return!e.includes(t)});if(9!==t.keyCode||this.shiftDown||this.node.focus(),9===t.keyCode&&this.shiftDown){var o=i.indexOf(this.activator);n(o,i).focus(),this.deactivatePopover()}}}},{key:"_elementPosition",value:function(t){var e=t.getBoundingClientRect(),i=e.top,o=e.bottom,n=e.right,r=e.left,a=window.pageYOffset;return i+=a,o+=a,{top:i,right:n,bottom:o,left:r,width:n-r,height:o-i}}},{key:"_resizePopover",value:function(){var t=this;this.activated&&window.requestAnimationFrame(function(){t._positionPopover()})}},{key:"_positionPopover",value:function(){var t=this._elementPosition(this.activator),e=t.left+t.width/2;this.constrainedWidth&&(this.node.style["max-width"]=t.width+"px"),this.node.style.left=null,this.node.style.right=null,this.node.style.height=null;var i=this._elementPosition(this.node),o=this.activated?1:s,n=i.width*o/2;this._calculateLeftRight(t,e,n),this._calculateHeight(t.bottom,i.height),this.node.style.top=t.top+t.height+a+"px",this.node.classList.add("popover--bottom-shadow")}},{key:"_calculateHeight",value:function(t){var e=window.innerHeight,i=this._elementPosition(this.contents).height,o=e-t-2*a;o-i<0&&(this.node.style.height=o+"px")}},{key:"_calculateLeftRight",value:function(t,e,i){var o=window.innerWidth,n=e-i,r=n>0,a=e+i>o;r&&(this.node.style.left=n+"px"),a&&(this.node.style.right=o-t.right+"px"),n<0&&(this.node.style.left=t.left+"px")}}]),t}();e["default"]=u}])});